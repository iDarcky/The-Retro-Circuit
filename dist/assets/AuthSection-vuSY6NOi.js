import{j as e,B as C}from"./ui-utils-Bc8hcx-Q.js";import{b as W,r as a,L as A}from"./vendor-react-DYQUvfhN.js";import{s as Y,j as k,r as c}from"./index-B-i4yEhk.js";const p=[{id:"pilot",name:"The Pilot",svg:s=>e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",...s,children:[e.jsx("circle",{cx:"12",cy:"12",r:"10"}),e.jsx("path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"}),e.jsx("path",{d:"M2 12h20"})]})},{id:"robot",name:"Droid Unit",svg:s=>e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",...s,children:[e.jsx("rect",{x:"3",y:"11",width:"18",height:"10",rx:"2"}),e.jsx("circle",{cx:"12",cy:"5",r:"2"}),e.jsx("path",{d:"M12 7v4"}),e.jsx("line",{x1:"8",y1:"16",x2:"8",y2:"16"}),e.jsx("line",{x1:"16",y1:"16",x2:"16",y2:"16"})]})},{id:"wizard",name:"8-Bit Mage",svg:s=>e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",...s,children:[e.jsx("path",{d:"M12 2l-4 4h8l-4-4z"}),e.jsx("rect",{x:"8",y:"6",width:"8",height:"10"}),e.jsx("path",{d:"M8 16l-2 4h12l-2-4"})]})},{id:"ninja",name:"Shadow Ops",svg:s=>e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",...s,children:[e.jsx("circle",{cx:"12",cy:"10",r:"4"}),e.jsx("path",{d:"M12 14c-4 0-6 4-6 6h12c0-2-2-6-6-6z"}),e.jsx("path",{d:"M4 10h2"}),e.jsx("path",{d:"M18 10h2"})]})},{id:"alien",name:"Invader",svg:s=>e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",...s,children:[e.jsx("path",{d:"M12 2c-4 0-7 3-7 7 0 2 1 4 3 5v4h2v-4h4v4h2v-4c2-1 3-3 3-5 0-4-3-7-7-7z"}),e.jsx("circle",{cx:"9",cy:"7",r:"1"}),e.jsx("circle",{cx:"15",cy:"7",r:"1"})]})},{id:"skull",name:"Game Over",svg:s=>e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",...s,children:[e.jsx("circle",{cx:"9",cy:"12",r:"1"}),e.jsx("circle",{cx:"15",cy:"12",r:"1"}),e.jsx("path",{d:"M8 20v2h8v-2"}),e.jsx("path",{d:"M12.5 17l-.5-1-.5 1h1z"}),e.jsx("path",{d:"M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20"})]})},{id:"floppy",name:"Save Data",svg:s=>e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",...s,children:[e.jsx("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}),e.jsx("polyline",{points:"17 21 17 13 7 13 7 21"}),e.jsx("polyline",{points:"7 3 7 8 15 8"})]})},{id:"controller",name:"Player 1",svg:s=>e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",...s,children:[e.jsx("rect",{x:"2",y:"6",width:"20",height:"12",rx:"2"}),e.jsx("path",{d:"M6 12h4m-2-2v4"}),e.jsx("circle",{cx:"17",cy:"11",r:"0.5"}),e.jsx("circle",{cx:"15",cy:"13",r:"0.5"})]})},{id:"ghost",name:"Glitch",svg:s=>e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",...s,children:[e.jsx("path",{d:"M9 22v-2H5v2H2V10a10 10 0 1 1 20 0v12h-3v-2h-4v2h-3v-2H9z"}),e.jsx("circle",{cx:"9",cy:"12",r:"1"}),e.jsx("circle",{cx:"15",cy:"12",r:"1"})]})},{id:"console",name:"System",svg:s=>e.jsxs("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",...s,children:[e.jsx("rect",{x:"2",y:"4",width:"20",height:"16",rx:"2"}),e.jsx("line",{x1:"6",y1:"12",x2:"6",y2:"12"}),e.jsx("line",{x1:"10",y1:"12",x2:"10",y2:"12"}),e.jsx("line",{x1:"14",y1:"12",x2:"14",y2:"12"}),e.jsx("line",{x1:"18",y1:"12",x2:"18",y2:"12"})]})}],B=({selectedId:s,onSelect:r})=>e.jsx("div",{className:"grid grid-cols-5 gap-2 p-2 bg-retro-dark border border-retro-grid",children:p.map(o=>e.jsx("button",{onClick:()=>r(o.id),className:`aspect-square flex items-center justify-center border-2 transition-all p-1 ${s===o.id?"border-retro-neon bg-retro-neon/20 shadow-[0_0_10px_rgba(0,255,157,0.5)]":"border-retro-grid hover:border-retro-blue hover:bg-retro-blue/10"}`,title:o.name,children:e.jsx(o.svg,{className:`w-8 h-8 ${s===o.id?"text-retro-neon":"text-gray-400"}`})},o.id))}),H=()=>{var w,O,R;const s=W(),[r,o]=a.useState("LOGIN"),[d,T]=a.useState(""),[h,D]=a.useState(""),[N,P]=a.useState(""),[m,g]=a.useState(null),[v,j]=a.useState("pilot"),[E,f]=a.useState([]),[U,S]=a.useState(!1),[b,i]=a.useState(null),[y,I]=a.useState(!1);a.useEffect(()=>{(async()=>{var x;const l=await c.getUser();if(l){g(l),o("PROFILE"),j(((x=l.user_metadata)==null?void 0:x.avatar_id)||"pilot");const u=await k();f(u)}})(),sessionStorage.getItem("retro_recovery_pending")==="true"&&(o("UPDATE_PASSWORD"),i({type:"success",text:"IDENTITY VERIFIED. ENTER NEW PASSCODE."}),sessionStorage.removeItem("retro_recovery_pending"));const{data:{subscription:t}}=Y.auth.onAuthStateChange(async(l,x)=>{var u;if(l==="PASSWORD_RECOVERY")o("UPDATE_PASSWORD"),i({type:"success",text:"IDENTITY VERIFIED. ENTER NEW PASSCODE."});else if(l==="SIGNED_IN"&&x){g(x.user),j(((u=x.user.user_metadata)==null?void 0:u.avatar_id)||"pilot"),o("PROFILE");const L=await k();f(L)}else l==="SIGNED_OUT"&&(g(null),o("LOGIN"))});return()=>t.unsubscribe()},[]);const _=async n=>{n.preventDefault(),S(!0),i(null);try{if(r==="SIGNUP"){const{error:t}=await c.signUp(d,h,N);if(t)throw t;i({type:"success",text:"SIGNAL TRANSMITTED. CHECK INBOX (AND JUNK) FOR UPLINK."})}else if(r==="LOGIN"){const{error:t}=await c.signIn(d,h);if(t)throw t}else if(r==="RECOVERY"){const{error:t}=await c.resetPassword(d);if(t)throw t;i({type:"success",text:"RECOVERY KEY TRANSMITTED. CHECK EMAIL TERMINAL."})}else if(r==="UPDATE_PASSWORD"){const{error:t}=await c.updateUserPassword(h);if(t)throw t;i({type:"success",text:"PASSCODE UPDATED. REDIRECTING..."}),setTimeout(()=>o("PROFILE"),2e3)}}catch(t){i({type:"error",text:t.message||"AUTHENTICATION FAILED"})}finally{S(!1)}},M=async()=>{await c.signOut(),s("/")},G=async n=>{j(n),await c.updateAvatar(n),I(!1)};if(r==="PROFILE"&&m){const n=((w=p.find(t=>t.id===v))==null?void 0:w.svg)||p[0].svg;return e.jsx("div",{className:"w-full max-w-4xl mx-auto p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"bg-retro-dark border-2 border-retro-grid p-6 text-center",children:[e.jsxs("div",{className:"relative inline-block mb-4",children:[e.jsx("div",{className:"w-24 h-24 border-2 border-retro-neon rounded-full flex items-center justify-center bg-retro-neon/10 mx-auto",children:e.jsx(n,{className:"w-16 h-16 text-retro-neon"})}),e.jsx("button",{onClick:()=>I(!y),className:"absolute bottom-0 right-0 bg-retro-blue text-black text-xs px-2 py-1 font-bold border border-white hover:bg-white transition-colors",children:"EDIT"})]}),y&&e.jsx("div",{className:"mb-4 animate-fadeIn",children:e.jsx(B,{selectedId:v,onSelect:G})}),e.jsx("h2",{className:"text-xl font-pixel text-white mb-1",children:((O=m.user_metadata)==null?void 0:O.username)||((R=m.email)==null?void 0:R.split("@")[0])}),e.jsx("div",{className:"text-xs font-mono text-gray-500 mb-6",children:m.email}),e.jsx(C,{onClick:M,variant:"danger",className:"w-full text-xs",children:"DISCONNECT"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("h3",{className:"font-pixel text-retro-blue mb-4 text-xl border-b border-retro-grid pb-2",children:"MY COLLECTION"}),E.length===0?e.jsxs("div",{className:"text-center py-12 border-2 border-dashed border-gray-800 text-gray-600 font-mono",children:["NO ITEMS IN INVENTORY.",e.jsx("br",{}),e.jsx(A,{to:"/games",className:"text-retro-neon underline mt-2 inline-block",children:"BROWSE GAMES"})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:E.map(t=>e.jsxs(A,{to:t.item_type==="GAME"?`/games/${t.item_id}`:`/consoles/${t.item_id}`,className:"flex items-center gap-3 p-3 border border-retro-grid bg-black/40 hover:bg-retro-grid/20 transition-colors group",children:[e.jsx("div",{className:"w-12 h-12 bg-black flex-shrink-0 flex items-center justify-center border border-gray-800",children:t.item_image?e.jsx("img",{src:t.item_image,className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-[10px] text-gray-600",children:"IMG"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-xs font-pixel text-white truncate group-hover:text-retro-neon",children:t.item_name}),e.jsxs("div",{className:"flex justify-between items-center mt-1",children:[e.jsx("span",{className:`text-[10px] font-mono px-1 ${t.status==="OWN"?"bg-retro-neon/20 text-retro-neon":"bg-retro-pink/20 text-retro-pink"}`,children:t.status}),e.jsx("span",{className:"text-[9px] font-mono text-gray-500",children:t.item_type})]})]})]},t.id))})]})]})})}return e.jsx("div",{className:"w-full max-w-md mx-auto p-4 min-h-[60vh] flex flex-col justify-center",children:e.jsxs("div",{className:"border-2 border-retro-grid bg-retro-dark p-8 shadow-[0_0_20px_rgba(0,255,157,0.1)]",children:[e.jsxs("h2",{className:"text-2xl font-pixel text-center text-retro-neon mb-6",children:[r==="LOGIN"&&"SYSTEM LOGIN",r==="SIGNUP"&&"NEW USER REGISTRATION",r==="RECOVERY"&&"PASSWORD RECOVERY",r==="UPDATE_PASSWORD"&&"SET NEW PASSWORD"]}),b&&e.jsx("div",{className:`p-3 mb-6 text-xs font-mono border ${b.type==="error"?"border-retro-pink text-retro-pink bg-retro-pink/10":"border-retro-neon text-retro-neon bg-retro-neon/10"}`,children:b.text}),e.jsxs("form",{onSubmit:_,className:"space-y-4",children:[r==="SIGNUP"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-mono text-retro-blue mb-1",children:"CODENAME (USERNAME)"}),e.jsx("input",{type:"text",required:!0,value:N,onChange:n=>P(n.target.value),className:"w-full bg-black border border-retro-grid p-2 text-white font-mono focus:border-retro-neon outline-none"})]}),(r==="LOGIN"||r==="SIGNUP"||r==="RECOVERY")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-mono text-retro-blue mb-1",children:"EMAIL FREQUENCY"}),e.jsx("input",{type:"email",required:!0,value:d,onChange:n=>T(n.target.value),className:"w-full bg-black border border-retro-grid p-2 text-white font-mono focus:border-retro-neon outline-none"})]}),(r==="LOGIN"||r==="SIGNUP"||r==="UPDATE_PASSWORD")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-mono text-retro-blue mb-1",children:"SECURITY CODE"}),e.jsx("input",{type:"password",required:!0,value:h,onChange:n=>D(n.target.value),className:"w-full bg-black border border-retro-grid p-2 text-white font-mono focus:border-retro-neon outline-none"})]}),e.jsxs(C,{type:"submit",isLoading:U,className:"w-full",children:[r==="LOGIN"&&"CONNECT",r==="SIGNUP"&&"REGISTER",r==="RECOVERY"&&"SEND LINK",r==="UPDATE_PASSWORD"&&"UPDATE"]})]}),e.jsxs("div",{className:"mt-6 flex flex-col gap-2 text-center text-xs font-mono text-gray-500",children:[r==="LOGIN"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>o("SIGNUP"),className:"hover:text-white",children:"CREATE NEW ACCOUNT"}),e.jsx("button",{onClick:()=>o("RECOVERY"),className:"hover:text-white",children:"LOST PASSWORD?"})]}),(r==="SIGNUP"||r==="RECOVERY")&&e.jsx("button",{onClick:()=>o("LOGIN"),className:"hover:text-white",children:"RETURN TO LOGIN"})]})]})})};export{H as default};
